<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Expenseo - Expense Tracker</title>
  <link rel="stylesheet" href="second.css">
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <style>
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    .animate-pulse-custom {
      animation: pulse 2s infinite;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">
  <div>
    <img src="./resources/piggy-bank.gif" class="fixed bottom-4 left-1/2 transform -translate-x-1/2 w-40 h-auto opacity-80 z-0" />
  </div>
  <div class="container mx-auto p-4">
    <!-- Animated Card -->
    <div class="flex justify-end mb-4">
      <a href="dummy.html" class="relative bg-[#8B78E6] text-white px-6 py-4 rounded-lg shadow-lg animate-pulse-custom hover:shadow-xl transition duration-300">
        Know where you are spending
        <span class="absolute top-0 right-0 mt-2 mr-2 text-sm">→</span>
      </a>
    </div>

    <!-- Action Buttons -->
    <div class="flex flex-wrap gap-4 mb-4">
      <button id="addExpenseBtn" class="bg-[#8B78E6] text-white px-4 py-2 rounded hover:bg-[#7a68d6] transition duration-300">
        Add Expense
      </button>
      <button id="deleteExpenseBtn" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition duration-300">
        Delete Last Expense
      </button>
      <button id="undoDeleteBtn" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition duration-300">
        Undo Delete
      </button>
    </div>

    <!-- Filters -->
    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4 space-y-4 md:space-y-0">
      <div>
        <label for="dateFilter" class="block mb-1 font-semibold">Filter by Date:</label>
        <select id="dateFilter" class="w-full md:w-48 border border-gray-300 rounded px-3 py-2">
          <option value="all">All</option>
          <option value="daily">Daily</option>
          <option value="monthly">Monthly</option>
          <option value="yearly">Yearly</option>
        </select>
      </div>
      <div>
        <label for="categoryFilter" class="block mb-1 font-semibold">Filter by Category:</label>
        <select id="categoryFilter" class="w-full md:w-48 border border-gray-300 rounded px-3 py-2">
          <option value="all">All</option>
          <option value="food">Food</option>
          <option value="transport">Transport</option>
          <option value="utilities">Utilities</option>
          <option value="entertainment">Entertainment</option>
        </select>
      </div>
    </div>

    <!-- Expenses Table -->
    <div class="overflow-x-auto">
      <table class="min-w-full bg-white rounded-lg shadow overflow-hidden">
        <thead class="bg-[#8B78E6] text-white">
          <tr>
            <th class="py-3 px-4 text-left">S.No</th>
            <th class="py-3 px-4 text-left">Name of Expense</th>
            <th class="py-3 px-4 text-left">Category</th>
            <th class="py-3 px-4 text-left">Date</th>
            <th class="py-3 px-4 text-left">Total Money Spent</th>
          </tr>
        </thead>
        <tbody id="expenseTableBody"></tbody>
      </table>
    </div>
  </div>

  <!-- Add Expense Modal -->
  <div id="addExpenseModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
    <div class="bg-white p-6 rounded shadow-lg w-96">
      <h2 class="text-xl font-bold mb-4">Add New Expense</h2>
      <form id="expenseForm" class="space-y-4">
        <div>
          <label for="expenseName" class="block text-sm font-medium text-gray-700">Name of Expense</label>
          <input type="text" id="expenseName" required class="mt-1 block w-full border border-gray-300 rounded px-3 py-2" />
        </div>
        <div>
          <label for="expenseCategory" class="block text-sm font-medium text-gray-700">Category</label>
          <select id="expenseCategory" required class="mt-1 block w-full border border-gray-300 rounded px-3 py-2">
            <option value="food">Food</option>
            <option value="transport">Transport</option>
            <option value="utilities">Utilities</option>
            <option value="entertainment">Entertainment</option>
          </select>
        </div>
        <div>
          <label for="expenseDate" class="block text-sm font-medium text-gray-700">Date</label>
          <input type="date" id="expenseDate" required class="mt-1 block w-full border border-gray-300 rounded px-3 py-2" />
        </div>
        <div>
          <label for="expenseAmount" class="block text-sm font-medium text-gray-700">Amount</label>
          <input type="number" id="expenseAmount" required class="mt-1 block w-full border border-gray-300 rounded px-3 py-2" />
        </div>
        <div class="flex justify-end space-x-2">
          <button type="button" id="cancelBtn" class="bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400">Cancel</button>
          <button type="submit" class="bg-[#8B78E6] text-white px-4 py-2 rounded hover:bg-[#7a68d6]">Add</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    let expenses = [
      { name: "Groceries", category: "food", date: "2025-04-30", amount: 1500 },
      { name: "Bus Ticket", category: "transport", date: "2025-04-29", amount: 50 },
      { name: "Electricity Bill", category: "utilities", date: "2025-04-28", amount: 1200 },
      { name: "Movie", category: "entertainment", date: "2025-04-27", amount: 300 }
    ];

    let deletedExpenses = [];

    const expenseTableBody = document.getElementById("expenseTableBody");
    const dateFilter = document.getElementById("dateFilter");
    const categoryFilter = document.getElementById("categoryFilter");
    const addExpenseBtn = document.getElementById("addExpenseBtn");
    const deleteExpenseBtn = document.getElementById("deleteExpenseBtn");
    const undoDeleteBtn = document.getElementById("undoDeleteBtn");
    const addExpenseModal = document.getElementById("addExpenseModal");
    const cancelBtn = document.getElementById("cancelBtn");
    const expenseForm = document.getElementById("expenseForm");

    function renderExpenses(data) {
      expenseTableBody.innerHTML = "";
      data.forEach((exp, index) => {
        const row = document.createElement("tr");
        row.className = "hover:bg-gray-100 transition duration-200";
        row.innerHTML = `
          <td class="py-2 px-4 border-b">${index + 1}</td>
          <td class="py-2 px-4 border-b">${exp.name}</td>
          <td class="py-2 px-4 border-b">${exp.category}</td>
          <td class="py-2 px-4 border-b">${exp.date}</td>
          <td class="py-2 px-4 border-b">₹${exp.amount}</td>
        `;
        expenseTableBody.appendChild(row);
      });
    }

    function filterExpenses() {
      let filtered = [...expenses];
      const category = categoryFilter.value;
      const dateOption = dateFilter.value;
      const today = new Date();

      if (category !== "all") {
        filtered = filtered.filter(exp => exp.category === category);
      }

      if (dateOption !== "all") {
        filtered = filtered.filter(exp => {
          const expDate = new Date(exp.date);
          if (dateOption === "daily") {
            return expDate.toDateString() === today.toDateString();
          } else if (dateOption === "monthly") {
            return expDate.getMonth() === today.getMonth() &&
                   expDate.getFullYear() === today.getFullYear();
          } else if (dateOption === "yearly") {
            return expDate.getFullYear() === today.getFullYear();
          }
        });
      }

      renderExpenses(filtered);
    }

    dateFilter.addEventListener("change", filterExpenses);
    categoryFilter.addEventListener("change", filterExpenses);

    addExpenseBtn.addEventListener("click", () => addExpenseModal.classList.remove("hidden"));
    cancelBtn.addEventListener("click", () => addExpenseModal.classList.add("hidden"));

    expenseForm.addEventListener("submit", e => {
      e.preventDefault();
      const name = document.getElementById("expenseName").value;
      const category = document.getElementById("expenseCategory").value;
      const date = document.getElementById("expenseDate").value;
      const amount = parseFloat(document.getElementById("expenseAmount").value);

      expenses.push({ name, category, date, amount });
      addExpenseModal.classList.add("hidden");
      expenseForm.reset();
      filterExpenses();
    });

    deleteExpenseBtn.addEventListener("click", () => {
      if (expenses.length) {
        const deleted = expenses.pop();
        deletedExpenses.push(deleted);
        filterExpenses();
      }
    });

    undoDeleteBtn.addEventListener("click", () => {
      if (deletedExpenses.length) {
        const restored = deletedExpenses.pop();
        expenses.push(restored);
        filterExpenses();
      }
    });

    renderExpenses(expenses);
  </script>
</body>
</html>
